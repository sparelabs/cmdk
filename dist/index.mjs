import{a as re}from"./chunk-XJATAMEX.mjs";import*as x from"@radix-ui/react-dialog";import*as t from"react";var fe='[cmdk-list-sizer=""]',A='[cmdk-group=""]',B='[cmdk-group-items=""]',me='[cmdk-group-heading=""]',J='[cmdk-item=""]',oe=`${J}:not([aria-disabled="true"])`,W="cmdk-item-select",C="data-value",ve=(r,s)=>re(r,s),ae=t.createContext(void 0),V=()=>t.useContext(ae),se=t.createContext(void 0),Q=()=>t.useContext(se),ie=t.createContext(void 0),pe=0,D=()=>"cmdk"+(pe++).toString(32),ce=t.forwardRef((r,s)=>{let n=t.useRef(null),o=w(()=>{var e;return{search:"",value:r.value??((e=r.defaultValue)==null?void 0:e.toLowerCase())??"",filtered:{count:0,items:new Map,groups:new Set}}}),l=w(()=>new Set),d=w(()=>new Map),f=w(()=>new Map),p=w(()=>new Set),u=le(r),{label:b,children:m,value:R,onValueChange:M,filter:I,shouldFilter:y,vimBindings:F=!0,...k}=r,K=D(),_=D(),g=D(),S=Te();P(()=>{if(R!==void 0){let e=R.trim().toLowerCase();o.current.value=e,S(6,Y),E.emit()}},[R]);let E=t.useMemo(()=>({subscribe:e=>(p.current.add(e),()=>p.current.delete(e)),snapshot:()=>o.current,setState:(e,c,a)=>{var i,v,h;if(!Object.is(o.current[e],c)){if(o.current[e]=c,e==="search")q(),j(),S(1,$);else if(e==="value")if(((i=u.current)==null?void 0:i.value)!==void 0){let L=c??"";(h=(v=u.current).onValueChange)==null||h.call(v,L);return}else a||S(5,Y);E.emit()}},emit:()=>{p.current.forEach(e=>e())}}),[]),N=t.useMemo(()=>({value:(e,c)=>{c!==f.current.get(e)&&(f.current.set(e,c),o.current.filtered.items.set(e,X(c)),S(2,()=>{j(),E.emit()}))},item:(e,c)=>(l.current.add(e),c&&(d.current.has(c)?d.current.get(c).add(e):d.current.set(c,new Set([e]))),S(3,()=>{q(),j(),o.current.value||$(),E.emit()}),()=>{f.current.delete(e),l.current.delete(e),o.current.filtered.items.delete(e);let a=H();S(4,()=>{q(),(a==null?void 0:a.getAttribute("id"))===e&&$(),E.emit()})}),group:e=>(d.current.has(e)||d.current.set(e,new Set),()=>{f.current.delete(e),d.current.delete(e)}),filter:()=>u.current.shouldFilter,label:b||r["aria-label"],commandRef:n,listId:K,inputId:g,labelId:_}),[]);function X(e){var a;let c=((a=u.current)==null?void 0:a.filter)??ve;return e?c(e,o.current.search):0}function j(){if(!n.current||!o.current.search||u.current.shouldFilter===!1)return;let e=o.current.filtered.items,c=[];o.current.filtered.groups.forEach(i=>{let v=d.current.get(i),h=0;v.forEach(L=>{let de=e.get(L);h=Math.max(de,h)}),c.push([i,h])});let a=n.current.querySelector(fe);O().sort((i,v)=>{let h=i.getAttribute(C),L=v.getAttribute(C);return(e.get(L)??0)-(e.get(h)??0)}).forEach(i=>{let v=i.closest(B);v?v.appendChild(i.parentElement===v?i:i.closest(`${B} > *`)):a.appendChild(i.parentElement===a?i:i.closest(`${B} > *`))}),c.sort((i,v)=>v[1]-i[1]).forEach(i=>{let v=n.current.querySelector(`${A}[${C}="${i[0]}"]`);v==null||v.parentElement.appendChild(v)})}function $(){let e=O().find(a=>!a.ariaDisabled),c=e==null?void 0:e.getAttribute(C);E.setState("value",c||void 0)}function q(){if(!o.current.search||u.current.shouldFilter===!1){o.current.filtered.count=l.current.size;return}o.current.filtered.groups=new Set;let e=0;for(let c of l.current){let a=f.current.get(c),i=X(a);o.current.filtered.items.set(c,i),i>0&&e++}for(let[c,a]of d.current)for(let i of a)if(o.current.filtered.items.get(i)>0){o.current.filtered.groups.add(c);break}o.current.filtered.count=e}function Y(){var c,a,i;let e=H();e&&(((c=e.parentElement)==null?void 0:c.firstChild)===e&&((i=(a=e.closest(A))==null?void 0:a.querySelector(me))==null||i.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function H(){var e;return(e=n.current)==null?void 0:e.querySelector(`${J}[aria-selected="true"]`)}function O(){return Array.from(n.current.querySelectorAll(oe))}function z(e){let a=O()[e];a&&E.setState("value",a.getAttribute(C))}function U(e){var h;let c=H(),a=O(),i=a.findIndex(L=>L===c),v=a[i+e];(h=u.current)!=null&&h.loop&&(v=i+e<0?a[a.length-1]:i+e===a.length?a[0]:a[i+e]),v&&E.setState("value",v.getAttribute(C))}function Z(e){let c=H(),a=c==null?void 0:c.closest(A),i;for(;a&&!i;)a=e>0?xe(a,A):Le(a,A),i=a==null?void 0:a.querySelector(oe);i?E.setState("value",i.getAttribute(C)):U(e)}let ee=()=>z(O().length-1),te=e=>{e.preventDefault(),e.metaKey?ee():e.altKey?Z(1):U(1)},ne=e=>{e.preventDefault(),e.metaKey?z(0):e.altKey?Z(-1):U(-1)};return t.createElement("div",{ref:G([n,s]),...k,"cmdk-root":"",onKeyDown:e=>{var c;if((c=k.onKeyDown)==null||c.call(k,e),!e.defaultPrevented)switch(e.key){case"n":case"j":{F&&e.ctrlKey&&te(e);break}case"ArrowDown":{te(e);break}case"p":case"k":{F&&e.ctrlKey&&ne(e);break}case"ArrowUp":{ne(e);break}case"Home":{e.preventDefault(),z(0);break}case"End":{e.preventDefault(),ee();break}case"Enter":if(!e.nativeEvent.isComposing){e.preventDefault();let a=H();if(a){let i=new Event(W);a.dispatchEvent(i)}}}}},t.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:Me},b),t.createElement(se.Provider,{value:E},t.createElement(ae.Provider,{value:N},m)))}),ge=t.forwardRef((r,s)=>{var _;let n=D(),o=t.useRef(null),l=t.useContext(ie),d=V(),f=le(r),p=((_=f.current)==null?void 0:_.forceMount)??(l==null?void 0:l.forceMount);P(()=>d.item(n,l==null?void 0:l.id),[]);let u=ue(n,o,[r.value,r.children,o]),b=Q(),m=T(g=>g.value&&g.value===u.current),R=T(g=>p||d.filter()===!1?!0:g.search?g.filtered.items.get(n)>0:!0);t.useEffect(()=>{let g=o.current;if(!(!g||r.disabled))return g.addEventListener(W,M),()=>g.removeEventListener(W,M)},[R,r.onSelect,r.disabled]);function M(){var g,S;I(),(S=(g=f.current).onSelect)==null||S.call(g,u.current)}function I(){b.setState("value",u.current,!0)}if(!R)return null;let{disabled:y,value:F,onSelect:k,...K}=r;return t.createElement("div",{ref:G([o,s]),...K,id:n,"cmdk-item":"",role:"option","aria-disabled":y||void 0,"aria-selected":m||void 0,"data-disabled":y||void 0,"data-selected":m||void 0,onPointerMove:y?void 0:I,onClick:y?void 0:M},r.children)}),Re=t.forwardRef((r,s)=>{let{heading:n,children:o,forceMount:l,...d}=r,f=D(),p=t.useRef(null),u=t.useRef(null),b=D(),m=V(),R=T(y=>l||m.filter()===!1?!0:y.search?y.filtered.groups.has(f):!0);P(()=>m.group(f),[]),ue(f,p,[r.value,r.heading,u]);let M=t.useMemo(()=>({id:f,forceMount:l}),[l]),I=t.createElement(ie.Provider,{value:M},o);return t.createElement("div",{ref:G([p,s]),...d,"cmdk-group":"",role:"presentation",hidden:R?void 0:!0},n&&t.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:b},n),t.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?b:void 0},I))}),be=t.forwardRef((r,s)=>{let{alwaysRender:n,...o}=r,l=t.useRef(null),d=T(f=>!f.search);return!n&&!d?null:t.createElement("div",{ref:G([l,s]),...o,"cmdk-separator":"",role:"separator"})}),he=t.forwardRef((r,s)=>{let{onValueChange:n,...o}=r,l=r.value!=null,d=Q(),f=T(m=>m.search),p=T(m=>m.value),u=V(),b=t.useMemo(()=>{var R;let m=(R=u.commandRef.current)==null?void 0:R.querySelector(`${J}[${C}="${p}"]`);return m==null?void 0:m.getAttribute("id")},[p,u.commandRef]);return t.useEffect(()=>{r.value!=null&&d.setState("search",r.value)},[r.value]),t.createElement("input",{ref:s,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":u.listId,"aria-labelledby":u.labelId,"aria-activedescendant":b,id:u.inputId,type:"text",value:l?r.value:f,onChange:m=>{l||d.setState("search",m.target.value),n==null||n(m.target.value)}})}),Ee=t.forwardRef((r,s)=>{let{children:n,...o}=r,l=t.useRef(null),d=t.useRef(null),f=V();return t.useEffect(()=>{if(d.current&&l.current){let p=d.current,u=l.current,b,m=new ResizeObserver(()=>{b=requestAnimationFrame(()=>{let R=p.offsetHeight;u.style.setProperty("--cmdk-list-height",R.toFixed(1)+"px")})});return m.observe(p),()=>{cancelAnimationFrame(b),m.unobserve(p)}}},[]),t.createElement("div",{ref:G([l,s]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:f.listId,"aria-labelledby":f.inputId},t.createElement("div",{ref:d,"cmdk-list-sizer":""},n))}),Se=t.forwardRef((r,s)=>{let{open:n,onOpenChange:o,overlayClassName:l,contentClassName:d,container:f,...p}=r;return t.createElement(x.Root,{open:n,onOpenChange:o},t.createElement(x.Portal,{container:f},t.createElement(x.Overlay,{"cmdk-overlay":"",className:l}),t.createElement(x.Content,{"aria-label":r.label,"cmdk-dialog":"",className:d},t.createElement(ce,{ref:s,...p}))))}),Ce=t.forwardRef((r,s)=>{let n=t.useRef(!0),o=T(l=>l.filtered.count===0);return t.useEffect(()=>{n.current=!1},[]),n.current||!o?null:t.createElement("div",{ref:s,...r,"cmdk-empty":"",role:"presentation"})}),ye=t.forwardRef((r,s)=>{let{progress:n,children:o,...l}=r;return t.createElement("div",{ref:s,...l,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},t.createElement("div",{"aria-hidden":!0},o))}),De=Object.assign(ce,{List:Ee,Item:ge,Input:he,Group:Re,Separator:be,Dialog:Se,Empty:Ce,Loading:ye});function xe(r,s){let n=r.nextElementSibling;for(;n;){if(n.matches(s))return n;n=n.nextElementSibling}}function Le(r,s){let n=r.previousElementSibling;for(;n;){if(n.matches(s))return n;n=n.previousElementSibling}}function le(r){let s=t.useRef(r);return P(()=>{s.current=r}),s}var P=typeof window>"u"?t.useEffect:t.useLayoutEffect;function w(r){let s=t.useRef();return s.current===void 0&&(s.current=r()),s}function G(r){return s=>{r.forEach(n=>{typeof n=="function"?n(s):n!=null&&(n.current=s)})}}function T(r){let s=Q(),n=()=>r(s.snapshot());return t.useSyncExternalStore(s.subscribe,n,n)}function ue(r,s,n){let o=t.useRef(),l=V();return P(()=>{var f;let d=(()=>{var p;for(let u of n){if(typeof u=="string")return u.trim().toLowerCase();if(typeof u=="object"&&"current"in u)return u.current?(p=u.current.textContent)==null?void 0:p.trim().toLowerCase():o.current}})();l.value(r,d),(f=s.current)==null||f.setAttribute(C,d),o.current=d}),o}var Te=()=>{let[r,s]=t.useState(),n=w(()=>new Map);return P(()=>{n.current.forEach(o=>o()),n.current=new Map},[r]),(o,l)=>{n.current.set(o,l),s({})}},Me={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{De as Command,Se as CommandDialog,Ce as CommandEmpty,Re as CommandGroup,he as CommandInput,ge as CommandItem,Ee as CommandList,ye as CommandLoading,ce as CommandRoot,be as CommandSeparator,T as useCommandState};
